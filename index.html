<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Royal's VÅ“ux 2026 - Bonne AnnÃ©e</title>
    <link rel="stylesheet" href="voeux.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="Capture d'Ã©cran 2025-12-29 121940.png">
    
    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { 
        getFirestore, 
        collection, 
        addDoc,
        getDocs,
        query,
        orderBy,
        limit
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCkT7JgTkmBYvDpHRbbL0eOoHt2hie_f7o",
        authDomain: "royals-voeux-2026-f8418.firebaseapp.com",
        projectId: "royals-voeux-2026-f8418",
        storageBucket: "royals-voeux-2026-f8418.firebasestorage.app",
        messagingSenderId: "307861108396",
        appId: "1:307861108396:web:4401525ebf39bc5bd1d109"
    };

    console.log("ğŸš€ Initialisation Firebase...");
    
    try {
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // Exposer Firebase globalement
        window.firebaseDb = db;
        window.firebaseModules = {
            collection,
            addDoc,
            getDocs,
            query,
            orderBy,
            limit
        };
        
        console.log("âœ… Firebase initialisÃ© avec succÃ¨s !");
        console.log("ğŸ“Š Projet ID:", firebaseConfig.projectId);
        
        // â­â­ IMPORTANT : Appeler la fonction d'initialisation â­â­
        if (typeof window.onFirebaseInitialized === 'function') {
            window.onFirebaseInitialized();
        }
        
        // Tester la connexion
        getDocs(collection(db, "wishes")).then((snapshot) => {
            console.log(`âœ… Connexion rÃ©ussie - ${snapshot.size} vÅ“ux`);
            
            // Mettre Ã  jour le statut dans la page
            const statusEl = document.getElementById('firebase-status-text');
            if (statusEl) {
                statusEl.textContent = `Firebase: ConnectÃ© (${snapshot.size} vÅ“ux)`;
                statusEl.style.color = '#10b981';
            }
            
        }).catch(error => {
            console.warn("âš ï¸ Erreur Firestore:", error);
        });
        
    } catch (error) {
        console.error("âŒ Erreur Firebase:", error);
    }
</script>
</head>
<body>
    <!-- Ã‰lÃ©ment audio pour la musique -->
    <audio id="background-music" loop preload="auto">
        <source src="musique-festive.mp3" type="audio/mpeg">
        Votre navigateur ne supporte pas l'Ã©lÃ©ment audio.
    </audio>

    <!-- Canvas pour les confettis -->
    <canvas id="confetti-canvas"></canvas>

    <!-- Conteneur pour les flocons de neige -->
    <div id="snowflakes-container"></div>

    <!-- ContrÃ´le de musique -->
    <div class="music-control">
        <button id="music-toggle" class="music-btn">
            ğŸµ Musique
        </button>
        <div id="volume-control" class="music-volume">
            <input type="range" min="0" max="100" value="50" class="volume-slider" id="volume-slider">
            <div style="margin-top: 8px; font-size: 0.8rem; color: var(--text-color);">
                Volume: <span id="volume-value">50</span>%
            </div>
        </div>
    </div>
    
    <!-- Modal de carte de vÅ“ux -->
    <div id="wish-card-modal" class="wish-card-modal">
        <div class="wish-card">
            <button onclick="closeWishCard()" class="close-wish-card" title="Fermer">Ã—</button>
            
            <div class="wish-card-header">
                <h2>ğŸ‰ Carte de VÅ“ux 2026 ğŸ‰</h2>
                <div class="wish-card-from" id="wish-card-from"></div>
            </div>
            <div class="wish-card-content">
                <div class="wish-card-message" id="wish-card-message"></div>
                <div class="wish-card-signature">
                    Avec toute mon affection,<br>
                    <strong>Gildas</strong>
                </div>
            </div>
            <div class="wish-card-share">
                <button onclick="shareOnWhatsApp()" class="share-btn whatsapp" title="Partager sur WhatsApp">
                    <span class="share-icon">ğŸ’¬</span>
                    <span class="share-text">WhatsApp</span>
                </button>
                <button onclick="shareOnFacebook()" class="share-btn facebook" title="Partager sur Facebook">
                    <span class="share-icon">ğŸ“˜</span>
                    <span class="share-text">Facebook</span>
                </button>
                <button onclick="copyWishCard()" class="share-btn copy" title="Copier la carte">
                    <span class="share-icon">ğŸ“‹</span>
                    <span class="share-text">Copier</span>
                </button>
                <button onclick="closeWishCard()" class="share-btn return-btn" title="Retour">
                    <span class="share-icon">â†©ï¸</span>
                    <span class="share-text">Retour</span>
                </button>
            </div>
            <div class="wish-card-footer">
                <small>Partagez l'amour et les bonnes ondes ! âœ¨</small>
            </div>
        </div>
    </div>

    <!-- Login admin -->
    <div id="admin-login-modal" class="admin-login-modal">
        <div class="admin-login-content">
            <button onclick="closeAdminLogin()" class="close-modal-btn">Ã—</button>
            <h2>ğŸ” Portail Administrateur</h2>
            <p>AccÃ©dez au panel de gestion des vÅ“ux</p>
            <input type="password" id="admin-password" class="admin-input" placeholder="Entrez le token admin" autocomplete="off">
            <button onclick="checkAdminLogin()" class="admin-login-btn">AccÃ©der au panel</button>
            <p style="margin-top: 15px; font-size: 0.8rem; color: var(--muted-color);">
                Token : seul Gildas le connait ğŸ˜Š
            </p>
            <div class="admin-info">
                <details>
                    <summary>â„¹ï¸ Information Firebase</summary>
                    <div id="firebase-status" style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 5px; font-size: 0.8rem;">
                        <div id="firebase-status-text">Chargement du statut Firebase...</div>
                    </div>
                </details>
            </div>
        </div>
    </div>

    <!-- Panel admin -->
    <div id="admin-panel" class="admin-panel">
        <div class="admin-panel-header">
            <h3>ğŸ”§ Administration des VÅ“ux</h3>
            <button onclick="closeAdminPanel()" class="close-admin-btn">Ã—</button>
        </div>
        
        <div class="admin-connection-status">
            <div class="connection-status-item">
                <span class="status-indicator" id="firebase-status-indicator">â—</span>
                <span class="status-text" id="firebase-status-admin">Firebase: VÃ©rification...</span>
            </div>
            <div class="connection-status-item">
                <span class="status-indicator" id="local-status-indicator">â—</span>
                <span class="status-text">Stockage local: <span id="local-count">0</span> vÅ“ux</span>
            </div>
        </div>
        
        <div class="admin-stats">
            <div class="admin-stats-grid">
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-total-count">0</div>
                    <div class="admin-stat-label">Total vÅ“ux</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-online-count">0</div>
                    <div class="admin-stat-label">En ligne</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-local-count">0</div>
                    <div class="admin-stat-label">Locaux</div>
                </div>
                <div class="admin-stat-item">
                    <div class="admin-stat-value" id="admin-visitors-count">0</div>
                    <div class="admin-stat-label">Visiteurs</div>
                </div>
            </div>
        </div>
        
        <div class="admin-wishes-section">
            <div class="admin-wishes-header">
                <h4>ğŸ“œ VÅ“ux reÃ§us</h4>
                <div class="admin-wishes-actions">
                    <button onclick="refreshAdminWishes()" class="admin-refresh-btn" title="RafraÃ®chir">ğŸ”„</button>
                    <div class="admin-wishes-count">
                        <span id="admin-messages-count">0</span> vÅ“ux
                    </div>
                </div>
            </div>
            <div class="admin-wishes-filter">
                <select id="admin-filter-select" class="admin-filter-select" onchange="filterAdminWishes()">
                    <option value="all">Tous les vÅ“ux</option>
                    <option value="today">Aujourd'hui</option>
                    <option value="week">Cette semaine</option>
                    <option value="month">Ce mois</option>
                    <option value="anonymous">Anonymes</option>
                    <option value="named">Avec nom</option>
                </select>
                <input type="text" id="admin-search-input" class="admin-search-input" placeholder="Rechercher..." onkeyup="searchAdminWishes()">
            </div>
            <div id="admin-wishes-list" class="admin-wishes-grid">
                <div class="admin-wishes-empty">
                    <p>Chargement des vÅ“ux...</p>
                </div>
            </div>
            <div class="admin-wishes-pagination">
                <button id="prev-page" class="pagination-btn" disabled>â† PrÃ©cÃ©dent</button>
                <span id="page-info">Page 1/1</span>
                <button id="next-page" class="pagination-btn" disabled>Suivant â†’</button>
            </div>
        </div>
        
        <div class="admin-actions">
            <button onclick="exportMessages()" class="admin-action-btn">
                <span class="action-icon">ğŸ“¥</span>
                <span class="action-text">Exporter</span>
            </button>
            <button onclick="syncAllMessages()" class="admin-action-btn">
                <span class="action-icon">ğŸ”„</span>
                <span class="action-text">Synchroniser</span>
            </button>
            <button onclick="clearAllMessages()" class="admin-action-btn delete" title="Supprimer tous les vÅ“ux de Firebase">
                <span class="action-icon">ğŸ—‘ï¸</span>
                <span class="action-text">Effacer tout</span>
            </button>
        </div>
        
        <div class="admin-backup-section">
            <h4>ğŸ’¾ Sauvegarde locale</h4>
            <div class="backup-info">
                <p><span id="backup-count">0</span> vÅ“ux sauvegardÃ©s localement</p>
                <button onclick="exportLocalBackup()" class="backup-btn">ğŸ“‹ Exporter backup</button>
                <button onclick="clearLocalBackup()" class="backup-btn delete">ğŸ—‘ï¸ Vider backup</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="site-header">
        <div class="site-header-inner">
            <div class="brand">
                <div class="brand-logo">
                    <img src="Capture d'Ã©cran 2025-12-29 121940.png" alt="Logo" class="logo-img" loading="lazy">
                </div>
                <div class="brand-text">
                    <strong style="color: white;">Gildas's</strong>
                    <span class="brand-subtitle">VÅ“ux 2026</span>
                </div>
            </div>
            <nav class="site-nav">
                <button id="theme-toggle" class="nav-btn" title="Changer le thÃ¨me">
                    <span class="nav-icon">ğŸŒ™</span>
                    <span class="nav-text">ThÃ¨me</span>
                </button>
                <button id="celebrate-btn" class="nav-btn celebrate-btn" title="Lancer les confettis">
                    <span class="nav-icon">ğŸŠ</span>
                    <span class="nav-text">CÃ©lÃ©brer</span>
                </button>
                <button onclick="openAdminLogin()" class="nav-btn admin-btn" title="AccÃ¨s administrateur">
                    <span class="nav-icon">ğŸ”§</span>
                    <span class="nav-text">Admin</span>
                </button>
            </nav>
            <button class="mobile-menu-btn" id="mobile-menu-btn">â˜°</button>
        </div>
        <div class="mobile-menu" id="mobile-menu">
            <button id="theme-toggle-mobile" class="mobile-menu-item">
                <span class="menu-icon">ğŸŒ™</span>
                <span class="menu-text">ThÃ¨me</span>
            </button>
            <button id="celebrate-btn-mobile" class="mobile-menu-item">
                <span class="menu-icon">ğŸŠ</span>
                <span class="menu-text">CÃ©lÃ©brer</span>
            </button>
            <button onclick="openAdminLogin()" class="mobile-menu-item">
                <span class="menu-icon">ğŸ”§</span>
                <span class="menu-text">Admin</span>
            </button>
            <button onclick="window.scrollTo({top: document.querySelector('.form-section').offsetTop, behavior: 'smooth'})" class="mobile-menu-item">
                <span class="menu-icon">âœï¸</span>
                <span class="menu-text">Ã‰crire mes vÅ“ux</span>
            </button>
        </div>
    </header>

    <div class="container">
        <!-- Section Hero -->
        <div class="hero-section">
            <div class="greeting-card" id="greeting-card">
                <div class="greeting-header">
                    <h1>ğŸ‰ Je vous souhaite ğŸ‰</h1>
                    <div class="greeting-subtitle">Une merveilleuse annÃ©e 2026</div>
                </div>
                <p class="greeting-message">
                    Pleine de bonheur, de succÃ¨s, de santÃ© et d'amour !<br>
                    Que cette nouvelle annÃ©e vous apporte joie et prospÃ©ritÃ©.
                </p>
                
                <div class="countdown" id="countdown">
                    <div class="countdown-title">ğŸ“… Nouvel An 2026 dans :</div>
                    <div class="countdown-inner">
                        <div class="time-segment">
                            <span class="num" id="cd-days">0</span>
                            <span class="label">Jours</span>
                        </div>
                        <div class="time-segment">
                            <span class="num" id="cd-hours">00</span>
                            <span class="label">Heures</span>
                        </div>
                        <div class="time-segment">
                            <span class="num" id="cd-mins">00</span>
                            <span class="label">Minutes</span>
                        </div>
                        <div class="time-segment">
                            <span class="num" id="cd-secs">00</span>
                            <span class="label">Secondes</span>
                        </div>
                    </div>
                    <div class="countdown-progress">
                        <div class="progress-bar" id="countdown-progress"></div>
                    </div>
                </div>
                
                <div class="greeting-actions">
                    <button onclick="window.scrollTo({top: document.querySelector('.form-section').offsetTop, behavior: 'smooth'})" class="scroll-to-form-btn">
                        <span class="btn-icon">âœï¸</span>
                        <span class="btn-text">Ã‰crire mes vÅ“ux</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Formulaire -->
        <div class="form-section">
            <div class="form-container">
                <h2>âœï¸ Ã‰crivez vos vÅ“ux pour 2026</h2>
                <p class="form-subtitle">Partagez vos souhaits et recevez une carte personnalisÃ©e</p>
                
                <div class="form-group">
                    <label for="name">
                        <span class="label-icon">ğŸ‘¤</span>
                        Votre prÃ©nom (optionnel)
                    </label>
                    <input id="name" type="text" placeholder="Ex: Emile, Sophie, Jean...">
                    <div class="form-hint">Votre nom sera associÃ© Ã  vos vÅ“ux</div>
                </div>
                
                <div class="form-group">
                    <label for="message">
                        <span class="label-icon">ğŸ’Œ</span>
                        Vos vÅ“ux pour moi
                    </label>
                    <textarea id="message" placeholder="Que souhaitez-vous pour moi en cette nouvelle annÃ©e ? Partagez vos vÅ“ux de bonheur, succÃ¨s, santÃ©, amour..."></textarea>
                    <div class="textarea-footer">
                        <div class="textarea-counter">
                            <span id="char-count">0</span>/500 caractÃ¨res
                        </div>
                        <div class="textarea-tips">
                            ğŸ’¡ Conseil : Soyez sincÃ¨re et personnalisÃ© !
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button class="btn btn-primary" onclick="submitMessage()" id="submit-btn">
                        <span class="btn-icon">âœ¨</span>
                        <span class="btn-text">Envoyer mes vÅ“ux</span>
                    </button>
                </div>
                
                <div class="form-info">
                    <div class="info-card">
                        <h4>ğŸ“ Comment Ã§a marche ?</h4>
                        <ol>
                            <li><strong>Remplissez</strong> le formulaire ci-dessus</li>
                            <li><strong>Envoyez</strong> vos vÅ“ux (ils sont sauvegardÃ©s)</li>
                            <li><strong>Recevez</strong> une carte personnalisÃ©e</li>
                            <li><strong>Partagez</strong> avec vos proches si vous le souhaitez</li>
                        </ol>
                    </div>
                    
                    <div class="privacy-notice">
                        <h4>ğŸ”’ ConfidentialitÃ©</h4>
                        <p>Vos vÅ“ux sont :</p>
                        <ul>
                            <li><strong>SauvegardÃ©s</strong> pour Gildas</li>
                           <li><strong>StockÃ©s en toute sÃ©curitÃ©</strong> sur Firebase</li>
                            <li><strong>Jamais partagÃ©s</strong> avec des tiers</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructions mobile -->
        <div class="mobile-instructions">
            <div class="instruction-card">
                <h3>ğŸ“± Comment envoyer vos vÅ“ux ?</h3>
                <div class="instruction-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <strong>Ã‰crivez</strong> vos vÅ“ux dans le formulaire
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <strong>Envoyez</strong> pour recevoir une carte
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <strong>Partagez</strong> votre carte personnalisÃ©e
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <strong>CÃ©lÃ©brez</strong> avec les animations festives !
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        
            
            <div class="footer-sections">
                <div class="footer-section">
                    <h4> Contactez-moi</h4>
                    <div class="contact-info">
                        <a href="tel:+22899522491" class="contact-link phone">
                            <span class="contact-icon">ğŸ“</span>
                            phone
                        </a>
                        <a href="mailto:mebounougildas@gmail.com?subject=VÅ“ux%202026" class="contact-link email">
                            <span class="contact-icon">âœ‰ï¸</span>
                            Email
                        </a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>ğŸ”— Liens rapides</h4>
                    <div class="quick-links">
                        <a href="#top" class="quick-link" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">â†‘ Retour en haut</a>
                        <a href="javascript:void(0)" class="quick-link" onclick="openAdminLogin()">ğŸ”§ Admin</a>
                        <a href="javascript:void(0)" class="quick-link" onclick="window.launchConfetti && launchConfetti()">ğŸŠ CÃ©lÃ©brer</a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>ğŸŒ Suivez-moi</h4>
                    <div class="footer-social">
                        <a href="https://wa.me/22899522491?text=Bonjour%20Gildas%20!%20Je%20viens%20de%20voir%20ton%20site%20de%20vÅ“ux%202026%20ğŸ‰" 
                           class="social-link whatsapp" target="_blank" title="WhatsApp">
                            <span class="social-icon">ğŸ’¬</span>
                            <span class="social-text">WhatsApp</span>
                        </a>
                        <a href="mailto:mebounougildas@gmail.com?subject=VÅ“ux%202026" 
                           class="social-link email" title="Email">
                            <span class="social-icon">âœ‰ï¸</span>
                            <span class="social-text">Email</span>
                        </a>
                        <a href="tel:+22899522491" 
                           class="social-link phone" title="Appeler">
                            <span class="social-icon">ğŸ“</span>
                            <span class="social-text">Appeler</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-copyright">
                <p>Â© 2025-2026 <strong>Gildas's VÅ“ux</strong> - Tous droits rÃ©servÃ©s</p>
                <p class="made-with">CrÃ©Ã© avec â¤ï¸ par Gildas pour partager l'amour en 2026</p>
                <div class="footer-tech">
                    <span class="tech-item">Firebase</span>
                    <span class="tech-item">HTML5</span>
                    <span class="tech-item">CSS3</span>
                    <span class="tech-item">JavaScript</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bouton retour en haut -->
    <button class="back-to-top" id="back-to-top" title="Retour en haut">â†‘</button>

    <!-- Notification Toast -->
    <div id="notification-toast" class="notification-toast"></div>

    <!-- Loader -->
    <div id="global-loader" class="global-loader">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <div class="loader-text">Chargement...</div>
        </div>
    </div>

    <script src="voeux.js"></script>
</body>
</html>